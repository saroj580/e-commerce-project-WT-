<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Lume-Ecommerce</title>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
        <link rel="stylesheet" href="style.css">
        <link rel="stylesheet" href="responsive-styles.css">
        <style>
            .user-account {
                position: relative;
            }
            
            .user-menu {
                position: absolute;
                top: 100%;
                right: 0;
                background: white;
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
                width: 180px;
                z-index: 1000;
                border-radius: 4px;
                display: none;
            }
            
            .user-menu.active {
                display: block;
            }
            
            .user-menu a {
                display: block;
                padding: 10px 15px;
                color: #1a1a1a;
                transition: 0.3s;
                font-size: 14px;
            }
            
            .user-menu a:hover {
                background: #e8f6ea;
                color: #088178;
            }
            
            .user-icon {
                cursor: pointer;
            }
            
            #navbar li:last-child {
                margin-right: 0;
            }
        </style>
    </head>

    <body>
        <!-- navbar section -->
        <section id="header">
            <a href="#"><img src="img/logo1.png" alt="logo" class="logo"></a>
            <div>
                <ul id="navbar">
                    <li><a class="active" href="index.html">Home</a></li>
                    <li><a href="shop.html">Shop</a></li>
                    <li><a href="blog.html">Blog</a></li>
                    <li><a href="about.html">About</a></li>
                    <li><a href="contact.html">Contact</a></li>
                    <li id="search-container">
                        <div class="search-wrapper">
                            <input type="text" id="search-input" placeholder="Search products...">
                            <div id="search-suggestions"></div>
                        </div>
                        <a href="#" id="search-icon"><i class="fa-solid fa-magnifying-glass"></i></a>
                    </li>
                    <li id="lg-bag"><a href="cart.html"><i class="fa-solid fa-bag-shopping"></i></a></li>
                    <li class="user-account">
                        <a href="#" class="user-icon"><i class="fa-solid fa-user"></i></a>
                        <div id="user-menu" class="user-menu">
                            <!-- Menu items will be loaded dynamically -->
                        </div>
                    </li>
                    <a href="#" id="close"><i class="fa-solid fa-xmark"></i></a>
                </ul>
            </div>
            <div id="mobile">
                <a href="cart.html"><i class="fa-solid fa-bag-shopping"></i></a>
                <i id="bar" class="fas fa-outdent"></i>
            </div>
        </section>

        <!-- Hero sectio -->
         <section id="hero">
            <h4>Trade-in-Offer</h4>
            <h2>Super value deals</h2>
            <h1>On all Products</h1>
            <p>Save more with coupons & upto 70% off!</p>
            <button>Shop Now</button>
         </section>

        <!-- features section -->
         <section id="feature" class="section-p1">
            <div class="fe-box">
                <img src="img/features/f1.png" >
                <h6>Free Shipping</h6>
            </div>
            <div class="fe-box">
                <img src="img/features/f2.png" >
                <h6>Online Order</h6>
            </div>
            <div class="fe-box">
                <img src="img/features/f3.png" >
                <h6>Save Money</h6>
            </div>
            <div class="fe-box">
                <img src="img/features/f4.png" >
                <h6>Promotions</h6>
            </div>
            <div class="fe-box">
                <img src="img/features/f5.png" >
                <h6>Happy Sell</h6>
            </div>
            <div class="fe-box">
                <img src="img/features/f6.png" >
                <h6>F24/7 Support</h6>
            </div>
         </section>
        
        <!-- Products 1 section -->
        <section id="product1" class="section-p1">
            <h2>Featured Products</h2>
            <p>Summer Collection new Modern Design</p>
            <div class="pro-container">
                <!-- Products will be loaded dynamically via API -->
                <div class="loading-spinner">Loading products...</div>
            </div>
        </section>
        
        <!-- Banner section -->
        <section id="banner" class="section-m1">
            <h4>Repair Services</h4>
            <h2>Up to <span>70% Off</span> - All t-Shirts & Accessories</h2>
            <button class="normal">Explore More</button>
        </section>

        <!-- Newsletter Section -->
        <section id="newsLetter" class="section-p1 section-m1">
            <div class="newsText">
                <h4>Sign Up for NewsLetter</h4>
                <p>Get Email updates for our latest Shop and <span>Special Offers.</span></p>
            </div>
            <div class="form">
                <input type="text" placeholder="your email address">
                <button class="normal">Sign Up</button>
            </div>
        </section>

        <!-- Footer section -->
        <section id="footer" class="section-m1">
            <div class="top-section">
                <div class="location">
                    <h4>Popular location</h4>
                    <a href="#">Kathmandu</a>
                    <a href="#">Nepalgunj</a>
                    <a href="#">Chitwan</a>
                    <a href="#">Pokhara</a>
                </div>
                <div class="Trending-location">
                    <h4>Trending location</h4>
                    <a href="#">Birgunj</a>
                    <a href="#">Rautahat</a>
                    <a href="#">Biratnagar</a>
                    <a href="#">jankapur</a>
                </div>
                <div class="about-us">
                    <h4>About Us</h4>
                    <a href="#">Tech@lume</a>
                </div>

                <div class="lume">
                    <h4>lume</h4>
                    <a href="#">Shop</a>
                    <a href="#">Blog</a>
                    <a href="#">Help</a>
                    <a href="#">Location</a>
                    <a href="#">Legal & privacy information</a>
                </div>

                <div class="follow-us">
                    <h4>Follow Us</h4>
                    <div class="icon">
                        <a href="#"><i class="fa-brands fa-facebook"></i></a>
                        <a href="#"><i class="fa-brands fa-instagram"></i></a>
                        <a href="#"><i class="fa-brands fa-x-twitter"></i></a>
                        <a href="#"><i class="fa-brands fa-linkedin"></i></a>
                    </div>
                </div>
            </div>
            <!-- Copyright section -->
            <div class="copyright">
                <p>&copy; 2025, Lume - Ecommerce</p>
            </div>
        </section>

        <script src="script.js"></script>
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                // Setup user menu functionality
                setupUserMenu();
                
                // Setup featured products section
                loadFeaturedProducts();
                
                // Button to shop page
                document.querySelector('#hero button').addEventListener('click', function() {
                    window.location.href = 'shop.html';
                });
                
                document.querySelector('#banner button').addEventListener('click', function() {
                    window.location.href = 'shop.html';
                });
            });
            
            // Function to set up user menu
            function setupUserMenu() {
                const userIcon = document.querySelector('.user-icon');
                const userMenu = document.getElementById('user-menu');
                
                // Toggle menu on click
                userIcon.addEventListener('click', function(e) {
                    e.preventDefault();
                    userMenu.classList.toggle('active');
                });
                
                // Close menu when clicking outside
                document.addEventListener('click', function(e) {
                    if (!e.target.closest('.user-account')) {
                        userMenu.classList.remove('active');
                    }
                });
                
                // Check if user is logged in
                const token = localStorage.getItem('userToken');
                const userData = JSON.parse(localStorage.getItem('userData') || '{}');
                
                // Update menu based on login status
                if (token) {
                    userMenu.innerHTML = `
                        <a href="profile.html"><i class="fa-solid fa-user-circle"></i> My Profile</a>
                        <a href="orders.html"><i class="fa-solid fa-box"></i> My Orders</a>
                        ${userData.isAdmin ? '<a href="admin-dashboard.html"><i class="fa-solid fa-gauge"></i> Admin Dashboard</a>' : ''}
                        <a href="#" id="logout"><i class="fa-solid fa-sign-out-alt"></i> Logout</a>
                    `;
                    
                    // Add logout functionality
                    document.getElementById('logout').addEventListener('click', function(e) {
                        e.preventDefault();
                        localStorage.removeItem('userToken');
                        localStorage.removeItem('userData');
                        window.location.reload();
                    });
                } else {
                    userMenu.innerHTML = `
                        <a href="login.html"><i class="fa-solid fa-sign-in-alt"></i> Login</a>
                        <a href="register.html"><i class="fa-solid fa-user-plus"></i> Register</a>
                    `;
                }
            }
            
            // Function to load featured products
            async function loadFeaturedProducts() {
                const container = document.querySelector('.pro-container');
                
                try {
                    const response = await fetch('http://localhost:5050/api/products?limit=8');
                    
                    if (!response.ok) {
                        throw new Error('Failed to fetch products');
                    }
                    
                    const data = await response.json();
                    
                    // Clear loading message
                    container.innerHTML = '';
                    
                    // Display products
                    if (data.products && data.products.length > 0) {
                        data.products.forEach(product => {
                            const productDiv = document.createElement('div');
                            productDiv.className = 'pro';
                            productDiv.innerHTML = `
                                <img src="${product.image}" alt="${product.name}">
                                <div class="des">
                                    <span>${product.brand}</span>
                                    <h5>${product.name}</h5>
                                    <div class="star">
                                        ${getStarRating(product.rating)}
                                    </div>
                                    <h4>$${product.price}</h4>
                                </div>
                                <a href="#" class="add-to-cart" data-id="${product._id}"><i class="fa-solid fa-bag-shopping cart"></i></a>
                            `;
                            
                            productDiv.addEventListener('click', (e) => {
                                if (!e.target.closest('.add-to-cart')) {
                                    window.location.href = `sproduct.html?id=${product._id}`;
                                }
                            });
                            
                            container.appendChild(productDiv);
                        });
                    } else {
                        container.innerHTML = '<p>No products found</p>';
                    }
                } catch (error) {
                    console.error('Error loading products:', error);
                    container.innerHTML = '<p>Failed to load products. Please try again later.</p>';
                }
            }
        </script>
    </body>
</html>
